<div class="page-shell">
  <!-- navbar sus stÃ¢nga -->
  <div class="top-nav">
    <app-navigation-bar></app-navigation-bar>
  </div>

  <div class="bg-decor bg-decor-1"></div>
  <div class="bg-decor bg-decor-2"></div>

  <div class="card" *ngIf="step === 1">
    <div class="card-header">
      <div class="logo-circle">R</div>
      <div>
        <h1>Reset password</h1>
        <p>Enter your email and weâ€™ll send you a reset link</p>
      </div>
    </div>

    <form [formGroup]="emailForm" class="form-body" (ngSubmit)="onSendEmail()">
      <div class="field">
        <label for="email">Email</label>
        <div
          class="input-wrapper"
          [class.input-error]="ef['email'].touched && ef['email'].invalid"
        >
          <span class="input-icon">ðŸ“¨</span>
          <input
            id="email"
            type="email"
            formControlName="email"
            placeholder="you@example.com"
          />
        </div>
        <p class="err" *ngIf="ef['email'].touched && ef['email'].errors?.['required']">
          Email is required.
        </p>
        <p class="err" *ngIf="ef['email'].touched && ef['email'].errors?.['email']">
          Please enter a valid email.
        </p>
      </div>

      <p class="err" *ngIf="serverError">{{ serverError }}</p>

      <button type="submit" [disabled]="isSubmitting || emailForm.invalid">
        <span *ngIf="!isSubmitting">Send reset link</span>
        <span *ngIf="isSubmitting">Sendingâ€¦</span>
      </button>

      <p class="foot small">
        Remembered your password?
        <a href="#">Back to login</a>
      </p>
    </form>
  </div>

  <!-- STEP 2 -->
  <div class="card" *ngIf="step === 2">
    <div class="card-header">
      <div class="logo-circle">N</div>
      <div>
        <h1>Set new password</h1>
        <p>Choose a strong password and confirm it</p>
      </div>
    </div>

    <form [formGroup]="passwordForm" class="form-body" (ngSubmit)="onChangePassword()">
      <div class="field">
        <label for="password">New password</label>
        <div
          class="input-wrapper"
          [class.input-error]="pf['password'].touched && pf['password'].invalid"
        >
          <span class="input-icon">ðŸ”’</span>
          <input
            id="password"
            type="password"
            formControlName="password"
            placeholder="Minimum 6 characters"
          />
        </div>
        <p class="err" *ngIf="pf['password'].touched && pf['password'].errors?.['required']">
          Password is required.
        </p>
        <p class="err" *ngIf="pf['password'].touched && pf['password'].errors?.['minlength']">
          Minimum 6 characters.
        </p>
      </div>

      <div class="field">
        <label for="confirmPassword">Confirm password</label>
        <div
          class="input-wrapper"
          [class.input-error]="
            (pf['confirmPassword'].touched && pf['confirmPassword'].invalid) || passwordMismatch
          "
        >
          <span class="input-icon">âœ…</span>
          <input
            id="confirmPassword"
            type="password"
            formControlName="confirmPassword"
            placeholder="Repeat password"
          />
        </div>
        <p class="err" *ngIf="pf['confirmPassword'].touched && pf['confirmPassword'].errors?.['required']">
          Please confirm your password.
        </p>
        <p class="err" *ngIf="passwordMismatch">
          Passwords do not match.
        </p>
      </div>

      <p class="err" *ngIf="serverError">{{ serverError }}</p>

      <button
        type="submit"
        [disabled]="isSubmitting || passwordForm.invalid || passwordMismatch"
      >
        <span *ngIf="!isSubmitting">Change password</span>
        <span *ngIf="isSubmitting">Savingâ€¦</span>
      </button>

      <p class="foot small">
        Back to
        <a href="#">login</a>
      </p>
    </form>
  </div>
</div>

